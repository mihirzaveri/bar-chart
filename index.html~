<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Test</title>
        <script type="text/javascript" src="d3/d3.v3.js"></script>
        <style type="text/css">
				
				svg {
					border-bottom: 1px;
				}
				
				.bar {
  					fill: #ddd;
				}
				
				.g-ESPN {
      			fill: orange;
    			}
    			
    			.g-minor-highlight {
					fill: #999;    			
    			}
    			
    			.g-label {
					font-family: arial, sans-serif;    			
    			}
    			
    			.axis path,
    			
    			.axis .domain {
  					display: none;
				}

				.axis.bottomaxis line {
  					stroke-width:1px;
  					stroke:#000;
				}

				.axis line {
    				fill: none;
    				stroke: black;
    				shape-rendering: crispEdges;
				}

				.axis text {
				    font-family: sans-serif;
				    font-size: 11px;
				}
				
</style>
    </head>
    <body>
        <script type="text/javascript">
        
        		//OVERARCHING Q'S:
        			//Why is the y-axis scale flipped upside down?
        			//Why is the width overlapping just a tiny bit with the axis?
        
        		//Defining the margins
            var margin = {top: 20, right: 100, bottom: 10, left: 0};

				//Defining variables for width and height
				var width = 950 - margin.left - margin.right,
				height = 600 - margin.top - margin.bottom;
				
				//Q: Why does appending the svg have to be stored as a variable and why isn't the variable being called anywhere?
				var svg = d3.select("body").append("svg")
				    .attr("width", width + margin.left + margin.right)
				    .attr("height", height + margin.top + margin.bottom)
				    .append("g")
				    //Q: What are the pluses?
				    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
				    
				 	//Y Scale
					
					var y = d3.scale.linear()
						.domain([5.6, 0])
				    	.range([height,0]);

					    
					//Axes
					
					//Q: What is going on here?
					var formatCount = d3.format(",.0f");
    				var f = d3.format("$.0f");	
					
					var yAxis = d3.svg.axis()
						.scale(y)					
						.tickFormat(f)
     					.tickValues([5,4,3,2,1,0])
     					.orient("right");
     				
     				var bottomyAxis = d3.svg.axis()
     					.scale(y)
     					.tickValues([0])
     					.tickSize(width)
     					.orient("right");
     									
					svg.append("g")
						.attr("class", "axis")
      				.attr("transform", "translate(" + width + ",0)" )
						.call(yAxis);
					
					svg.append("g")
      				.attr("class", "bottomaxis")
      				.attr("transform", "translate(0," + height + ")" )
      				.call(bottomyAxis)
      				.attr("class", "axis bottomaxis");
		
				
				//This section loading data, making data number from string, then joining it to bars for the bar chart.
				d3.csv("subscription-prices.csv", function(err, prices) {
					
					prices.forEach(function(d) {
    				// recasts d.2013 as a number, not a string
    				d.X2013 = +d.X2013;
					});
					
					prices.sort(function(a,b) {
    					return a.X2013 - b.X2013;
					});
				
					//X scale
					
					var x = d3.scale.ordinal()
					    .domain([0,prices.length])
					    .range([0,width]);
					    
					var networks = ["Comedy Central","TNT", "C-SPAN"];
				    
				  	var bar = svg.selectAll(".bar")
						.data(prices)
						.enter().append("rect")
						.attr("height", function(d) { 
											return y(d.X2013); 
											})
						.attr("width", 4)
       				.attr("x", function(d, i) {
       									return 4.4 * i;
       									})
       				.attr("y", function(d) { 
       									return height - y(d.X2013)  
       									})
						.attr("class", "bar")
				
						//Identifying the networks that are identified in the NYT graphic (dark grey)					 	
						
						.classed("g-ESPN", function(d) { 
													return d.Network == "ESPN"
												})
						.classed("g-minor-highlight", function(d) { 
																	return networks.indexOf(d.Network) >= 0; 
																});
														
					console.log(prices)
				});
				
				//Labels for highlighted Networks
				
				svg.append("text")
					.attr("class", "g-label")
				 	.attr("x", 530)
				  	.attr("y", 30)
				  	.text("ESPN");			
				    
        </script>
    </body>
</html>     